# Usage of `flutter_genui`

`flutter_genui` is a Flutter library that enables developers to easily add
interactive generative UI to their applications.

## Key components

* **`UiAgent`**: The main entry point of the package. It manages the
  conversation with the LLM, handles UI state, and orchestrates the interaction
  between the app, its UI, and the AI.

* **`AiClient`**: A client that manages communication with your LLM. The package
  includes an (optional) `FirebaseAiClient` to communicate with Google's Gemini
  models (using Firebase AI Logic), and you can create your own subclasses for
  other models or LLM libraries.

* **`GenUiSurface`**: A Flutter widget that displays UI generated by the agent.
  It listens for updates from `UiAgent` and dynamically renders the generated
  UI.

* **`Catalog`**: A catalog of Flutter widgets that the AI is allowed to
  generate. For each widget, you define a name, a schema that describes the data
  needed by the widget, and a builder function. The built-in `CoreCatalogItems`
  include widgets for rendering text, markdown, and images.

* **`GenUiManager`**: The core state manager for generated UI. You won't often
  interact directly with this class, but it's responsible for managing the flow
  of information and events between the agent and your UI.

## Use cases

* Incorporate graphical UI into chatbots: instead of describing a list of products in text,
  the LLM can render an interactive carousel of product widgets. Instead of asking for a user to
  type out answers to questions, the LLM can render sliders, checkboxes, and more.
* Create dynamically composed UIs: an agent can generate a complete form with sliders, date pickers,
  and text fields on the fly based on a user's request to "book a flight."

## Example

### Using the GenUI SDK with Firebase AI Logic

The following example assumes the app ahs been configured to work with Firebase
AI Logic. See [setup.md](setup.md) for instructions on how to do so.

```dart
// Adding your widgets into the catalog.
// Start with the built-in catalog and add your own custom widgets.
final catalog = CoreCatalogItems.asCatalog().copyWith([
  myCustomNewWidget,
]);

/// Initializing the library.
final genUiManager = GenUiManager(catalog: catalog);
final aiClient = FirebaseAiClient(
  systemInstruction: '''
  You are a bicycle maintenance assistant who is an expert in diagnosing issues and
  giving step-by-step instructions.
  ''',
  tools: genUiManager.getTools(),
);
late final _uiAgent = UiAgent(
  genUiManager: genUiManager,
  aiClient: aiClient,
  onSurfaceAdded: _onSurfaceAdded,
  onSurfaceDeleted: (_) {},
);

// Put the surface, added by AI, to the list of messages that should be rendered,
// trigger re-render, and scroll to bottom.
void _onSurfaceAdded(SurfaceAdded surface) {
  if (!mounted) return;
  setState(() {
    _messages.add(MessageController(surfaceId: surface.surfaceId));
  });
  _scrollToBottom();
}

// Render that UI.
Widget build(BuildContext context) {
   if (type == MessageType.genUi) {
     return GenUiSurface(
       host: _uiAgent.host,
       surfaceId: _surfaceId,
       onEvent: _handleEvent,
     );
   }
}
```
